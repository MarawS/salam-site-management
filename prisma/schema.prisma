// prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Site_Inventory {
  id                String   @id @default(cuid())
  Site_ID           String   // Can have duplicates for different technologies
  Legacy_Site_ID    String?
  Site_Group        String?
  Site_Type         String?
  Region13          String?
  Region5           String?
  City              String?
  District          String?  // Different for same Site_ID with different tech
  Latitude          Float?   // Different for same Site_ID with different tech
  Longitude         Float?   // Different for same Site_ID with different tech
  Status            String?
  Operator_Owner    String?
  Technology        String   // 5G, MW, GPON, etc.
  
  // WHO updated/inserted the data
  Technician_Name   String
  Technician_Email  String
  
  devices           Device_Inventory[]
  
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt

  @@index([Site_ID])
  @@index([Technology])
  @@index([Site_ID, Technology])
  @@index([Latitude, Longitude])
  @@index([Technician_Email])
}

model Device_Inventory {
  id                  String   @id @default(cuid())
  Serial_Number       String?
  NE_Name             String   // Network Element Name
  Site_ID             String
  Operator_ID         String?
  NE_IP_Address       String?
  NE_MAC_Address      String?
  Model_Number        String?
  Vendor              String?
  Device_Type         String?
  Equipment_Role      String?
  Technology          String?
  Domain              String?
  Sub_Domain          String?
  Installation_Date   DateTime?
  
  // WHO updated/inserted the data
  Technician_Name     String
  Technician_Email    String
  
  site                Site_Inventory @relation(fields: [siteInventoryId], references: [id], onDelete: Cascade)
  siteInventoryId     String
  
  createdAt           DateTime @default(now())
  updatedAt           DateTime @updatedAt

  // UNIQUE CONSTRAINT: NE_Name + Site_ID
  @@unique([NE_Name, Site_ID])
  @@index([NE_Name])
  @@index([Site_ID])
  @@index([Vendor])
  @@index([Technology])
  @@index([Technician_Email])
}